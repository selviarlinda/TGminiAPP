# Используем официальный легковесный образ Node.js
FROM node:18-alpine

# Устанавливаем рабочую директорию внутри контейнера
WORKDIR /usr/src/app

# Копируем файлы package.json и package-lock.json для установки зависимостей
# Это делается отдельно, чтобы Docker мог кешировать этот слой, если зависимости не менялись
COPY package*.json ./

# Устанавливаем только те зависимости, которые нужны для работы приложения (не для разработки)
RUN npm ci --only=production

# Копируем остальной код нашего приложения
COPY . .

# Указываем порт, на котором будет работать наше приложение внутри контейнера
EXPOSE 5000

# Команда, которая будет выполняться при запуске контейнера
CMD [ "node", "src/index.js" ]
